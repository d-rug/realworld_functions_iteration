<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Function writing | Real-world function writing</title>
  <meta name="description" content="Function writing | Real-world function writing" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Function writing | Real-world function writing" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="d-rug/realworld_functions_iteration" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Function writing | Real-world function writing" />
  
  
  

<meta name="author" content="Liza Wood" />


<meta name="date" content="2022-10-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="repetitive-coding-tasks.html"/>
<link rel="next" href="iterating.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://d-rug.github.io/">
  <img src="https://github.com/d-rug/d-rug.github.io/raw/main/DRUG_final_cobalt.png" style="height: 100%; width: 100%; object-fit: contain" />
</a></li>
<li><a href="./" style="font-size: 18px">Real-world function writing</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="" data-path="repetitive-coding-tasks.html"><a href="repetitive-coding-tasks.html"><i class="fa fa-check"></i>Repetitive coding tasks</a></li>
<li class="chapter" data-level="" data-path="function-writing.html"><a href="function-writing.html"><i class="fa fa-check"></i>Function writing</a></li>
<li class="chapter" data-level="" data-path="iterating.html"><a href="iterating.html"><i class="fa fa-check"></i>Iterating</a></li>
<li class="chapter" data-level="" data-path="putting-it-together.html"><a href="putting-it-together.html"><i class="fa fa-check"></i>Putting it together</a></li>
<li class="divider"></li>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">
  <img alt="CC BY-SA 4.0" src="https://img.shields.io/badge/License-CC%20BY--NC--SA%204.0-lightgrey.svg" style="float: right; padding-right: 10px;" />
</a>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Real-world function writing</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="function-writing" class="section level1 unnumbered hasAnchor">
<h1>Function writing<a href="function-writing.html#function-writing" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Let’s first take the three lines of code that we were writing to edit one single file, and make it generalizable. Below is the one-at-a-time version. What is it that we’re actually changing each time in this repeated code below?</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="function-writing.html#cb6-1" aria-hidden="true" tabindex="-1"></a>patent77_1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;~/Box/d-rug/data/uspto_1977_1.csv&quot;</span>)</span>
<span id="cb6-2"><a href="function-writing.html#cb6-2" aria-hidden="true" tabindex="-1"></a>patent77_1<span class="sc">$</span>App_Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="fu">as.character</span>(patent77_1<span class="sc">$</span>App_Date))</span>
<span id="cb6-3"><a href="function-writing.html#cb6-3" aria-hidden="true" tabindex="-1"></a>patent77_1<span class="sc">$</span>Issue_Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="fu">as.character</span>(patent77_1<span class="sc">$</span>Issue_Date))</span>
<span id="cb6-4"><a href="function-writing.html#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="function-writing.html#cb6-5" aria-hidden="true" tabindex="-1"></a>patent77_2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;~/Box/d-rug/data/uspto_1977_2.csv&quot;</span>)</span>
<span id="cb6-6"><a href="function-writing.html#cb6-6" aria-hidden="true" tabindex="-1"></a>patent77_2<span class="sc">$</span>App_Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="fu">as.character</span>(patent77_2<span class="sc">$</span>App_Date))</span>
<span id="cb6-7"><a href="function-writing.html#cb6-7" aria-hidden="true" tabindex="-1"></a>patent77_2<span class="sc">$</span>Issue_Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="fu">as.character</span>(patent77_2<span class="sc">$</span>Issue_Date))</span></code></pre></div>
<p>The filepath is the main thing that changes each time (and the name we assign to the output). But let’s focus on the filepath for now. To start writing a function, you want to give your function a name (I’ll call mine ‘process_patents’) and assign it using the <code>function()</code> function (trippy, I know). Inside the arguments of the function function will be the argument, the thing we want to generalize, in this case, the filepath.</p>
<p>Let’s look at an example. I start by opening up the function with the curly brackets, pasting in the non-generalized code, and replacing the “repeated” thing with the argument. For now I have also changed the object name to df for simplicity.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="function-writing.html#cb7-1" aria-hidden="true" tabindex="-1"></a>process_patents <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb7-2"><a href="function-writing.html#cb7-2" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(x)</span>
<span id="cb7-3"><a href="function-writing.html#cb7-3" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>App_Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="fu">as.character</span>(df<span class="sc">$</span>App_Date))</span>
<span id="cb7-4"><a href="function-writing.html#cb7-4" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>Issue_Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="fu">as.character</span>(df<span class="sc">$</span>Issue_Date))</span>
<span id="cb7-5"><a href="function-writing.html#cb7-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Note that we don’t need to name our argument x, we can name it whatever we want. It might be better to give it a more literal name, such as ‘filepath’. You just need to make sure you change it in the function’s arguments and inside the function text itself.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="function-writing.html#cb8-1" aria-hidden="true" tabindex="-1"></a>process_patents <span class="ot">&lt;-</span> <span class="cf">function</span>(filepath){</span>
<span id="cb8-2"><a href="function-writing.html#cb8-2" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(filepath)</span>
<span id="cb8-3"><a href="function-writing.html#cb8-3" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>App_Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="fu">as.character</span>(df<span class="sc">$</span>App_Date))</span>
<span id="cb8-4"><a href="function-writing.html#cb8-4" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>Issue_Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="fu">as.character</span>(df<span class="sc">$</span>Issue_Date))</span>
<span id="cb8-5"><a href="function-writing.html#cb8-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s give this a go.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="function-writing.html#cb9-1" aria-hidden="true" tabindex="-1"></a>patent77_1 <span class="ot">&lt;-</span> <span class="fu">process_patents</span>(<span class="at">filepath =</span> <span class="st">&quot;~/Box/d-rug/data/uspto_1977_1.csv&quot;</span>)</span>
<span id="cb9-2"><a href="function-writing.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(patent77_1)</span></code></pre></div>
<pre><code>##         Min.      1st Qu.       Median         Mean      3rd Qu.         Max. 
## &quot;1977-01-04&quot; &quot;1977-01-04&quot; &quot;1977-01-04&quot; &quot;1977-01-04&quot; &quot;1977-01-04&quot; &quot;1977-01-04&quot;</code></pre>
<p>Our output is NOT what we would have expected. What happened? We didn’t ask the object to return the ‘df’ data frame, so it returned the last value it ran, which related to the issue date. To fix this, we just need one more line of code in the function.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="function-writing.html#cb11-1" aria-hidden="true" tabindex="-1"></a>process_patents <span class="ot">&lt;-</span> <span class="cf">function</span>(filepath){</span>
<span id="cb11-2"><a href="function-writing.html#cb11-2" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(filepath)</span>
<span id="cb11-3"><a href="function-writing.html#cb11-3" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>App_Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="fu">as.character</span>(df<span class="sc">$</span>App_Date))</span>
<span id="cb11-4"><a href="function-writing.html#cb11-4" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>Issue_Date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="fu">as.character</span>(df<span class="sc">$</span>Issue_Date))</span>
<span id="cb11-5"><a href="function-writing.html#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(df)</span>
<span id="cb11-6"><a href="function-writing.html#cb11-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now let’s see</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="function-writing.html#cb12-1" aria-hidden="true" tabindex="-1"></a>patent77_1 <span class="ot">&lt;-</span> <span class="fu">process_patents</span>(<span class="at">filepath =</span> <span class="st">&quot;~/Box/d-rug/data/uspto_1977_1.csv&quot;</span>)</span>
<span id="cb12-2"><a href="function-writing.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(patent77_1)</span></code></pre></div>
<pre><code>##      WKU               Title              App_Date         
##  Length:1484        Length:1484        Min.   :1960-10-18  
##  Class :character   Class :character   1st Qu.:1974-12-26  
##  Mode  :character   Mode  :character   Median :1975-05-28  
##                                        Mean   :1975-02-22  
##                                        3rd Qu.:1975-09-25  
##                                        Max.   :1976-07-01  
##    Issue_Date           Inventor           Assignee          ICL_Class        
##  Min.   :1977-01-04   Length:1484        Length:1484        Length:1484       
##  1st Qu.:1977-01-04   Class :character   Class :character   Class :character  
##  Median :1977-01-04   Mode  :character   Mode  :character   Mode  :character  
##  Mean   :1977-01-04                                                           
##  3rd Qu.:1977-01-04                                                           
##  Max.   :1977-01-04                                                           
##   References           Claims         
##  Length:1484        Length:1484       
##  Class :character   Class :character  
##  Mode  :character   Mode  :character  
##                                       
##                                       
## </code></pre>
<p>Better. But this still only reduces our code chunk from 3 to 1, but still leaves us to paste in every file path. So now it is time to move to iteration.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="repetitive-coding-tasks.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="iterating.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/d-rug/realworld_functions_iteration/edit/master/02_function_writing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/d-rug/realworld_functions_iteration/blob/master/02_function_writing.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
